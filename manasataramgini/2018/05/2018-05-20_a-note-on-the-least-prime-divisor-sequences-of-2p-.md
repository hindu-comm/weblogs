+++
title = "A note on the least prime divisor sequences of 2p plus or minus 1"
date = "2018-05-20"
upstream_url = "https://manasataramgini.wordpress.com/2018/05/20/a-note-on-the-least-prime-divisor-sequences-of-2p-plus-or-minus-1/"

+++
Source: [here](https://manasataramgini.wordpress.com/2018/05/20/a-note-on-the-least-prime-divisor-sequences-of-2p-plus-or-minus-1/).

Let
![p](https://s0.wp.com/latex.php?latex=p&bg=ffffff&fg=333333&s=0&c=20201002)
be the sequence of prime numbers: 2, 3, 5, 7… Define the sequences
![q](https://s0.wp.com/latex.php?latex=q&bg=ffffff&fg=333333&s=0&c=20201002)
such that ![q\[n\]=2p\[n\]\\pm 1](https://s0.wp.com/latex.php?latex=q%5Bn%5D%3D2p%5Bn%5D%5Cpm+1&bg=ffffff&fg=333333&s=0&c=20201002). Then sequence
![f_1](https://s0.wp.com/latex.php?latex=f_1&bg=ffffff&fg=333333&s=0&c=20201002)
is defined such that
![f_1\[n\]](https://s0.wp.com/latex.php?latex=f_1%5Bn%5D&bg=ffffff&fg=333333&s=0&c=20201002)
is the lowest prime divisor (LPD) of
![q\[n\]=2p\[n\]+1](https://s0.wp.com/latex.php?latex=q%5Bn%5D%3D2p%5Bn%5D%2B1&bg=ffffff&fg=333333&s=0&c=20201002)
and sequence
![f_2](https://s0.wp.com/latex.php?latex=f_2&bg=ffffff&fg=333333&s=0&c=20201002)
is defined so that
![f_2\[n\]](https://s0.wp.com/latex.php?latex=f_2%5Bn%5D&bg=ffffff&fg=333333&s=0&c=20201002)
is the LPD of
![q\[n\]=2p\[n\]-1](https://s0.wp.com/latex.php?latex=q%5Bn%5D%3D2p%5Bn%5D-1&bg=ffffff&fg=333333&s=0&c=20201002).

![f_1:](https://s0.wp.com/latex.php?latex=f_1%3A&bg=ffffff&fg=333333&s=0&c=20201002) 5, 7, 11, 3, 23, 3, 5, 3, 47, 59…  
![f_2:](https://s0.wp.com/latex.php?latex=f_2%3A&bg=ffffff&fg=333333&s=0&c=20201002)
3, 5, 3, 13, 3, 5, 3, 37, 3, 3…

[![primes2p_plus_1\_1](https://manasataramgini.files.wordpress.com/2018/05/primes2p_plus_1_1.png?w=640)](https://manasataramgini.files.wordpress.com/2018/05/primes2p_plus_1_1.png)Figure 1. A plot of the first 100 terms of ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002)

We observe that for
![f_1](https://s0.wp.com/latex.php?latex=f_1&bg=ffffff&fg=333333&s=0&c=20201002)
the successive record values (i.e. successive maxima), ![M\_{2p\\pm 1}](https://s0.wp.com/latex.php?latex=M_%7B2p%5Cpm+1%7D&bg=ffffff&fg=333333&s=0&c=20201002), are what are called safe primes and the corresponding
![p\[n\]](https://s0.wp.com/latex.php?latex=p%5Bn%5D&bg=ffffff&fg=333333&s=0&c=20201002)
is a Sophie Germain prime. For ![f_1\[n\] \\ge 11](https://s0.wp.com/latex.php?latex=f_1%5Bn%5D+%5Cge+11&bg=ffffff&fg=333333&s=0&c=20201002) these ![M\_{2p\\pm 1}](https://s0.wp.com/latex.php?latex=M_%7B2p%5Cpm+1%7D&bg=ffffff&fg=333333&s=0&c=20201002) values are primes of the form
![12n-1](https://s0.wp.com/latex.php?latex=12n-1&bg=ffffff&fg=333333&s=0&c=20201002).
In the case of
![f_2](https://s0.wp.com/latex.php?latex=f_2&bg=ffffff&fg=333333&s=0&c=20201002)
when ![f_2\[n\] \\ge 13](https://s0.wp.com/latex.php?latex=f_2%5Bn%5D+%5Cge+13&bg=ffffff&fg=333333&s=0&c=20201002) the successive ![M\_{2p\\pm 1}](https://s0.wp.com/latex.php?latex=M_%7B2p%5Cpm+1%7D&bg=ffffff&fg=333333&s=0&c=20201002) values are primes of the form
![12n+1](https://s0.wp.com/latex.php?latex=12n%2B1&bg=ffffff&fg=333333&s=0&c=20201002).
From Figure 1 we observe that though the record values keep rising for these sequences for most part they assume low values. Obviously, the lowest value it can take is 3. We also observe that frequency of the occurrence of the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime in these sequences from 3 upwards keeps decreasing. Below we tabulate the frequencies for the first 10 primes in ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002) for ![n \\le 25997](https://s0.wp.com/latex.php?latex=n+%5Cle+25997&bg=ffffff&fg=333333&s=0&c=20201002). The 3th column has the frequencies of the first 10 primes in the sequence of LPDs of odd numbers
![2n+1](https://s0.wp.com/latex.php?latex=2n%2B1&bg=ffffff&fg=333333&s=0&c=20201002)
up to some large
![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002).

![primes2p_plus_1\_tab](https://manasataramgini.files.wordpress.com/2018/05/primes2p_plus_1_tab.jpg?w=640)

[![primes2p_plus_1\_2](https://manasataramgini.files.wordpress.com/2018/05/primes2p_plus_1_2.png?w=640)](https://manasataramgini.files.wordpress.com/2018/05/primes2p_plus_1_2.png)Figure 2. Frequencies of the first 100 primes in ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002)
(blue and red). The frequencies of the first 100 primes in the sequence
of LPDs of odd numbers up to some large
![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002)
(cyan). The curve
![y=\\tfrac{1}{2x^2}](https://s0.wp.com/latex.php?latex=y%3D%5Ctfrac%7B1%7D%7B2x%5E2%7D&bg=ffffff&fg=333333&s=0&c=20201002)
is shown in green for comparison.

From the above we see that the frequencies of the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
primes in the sequences ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002) are very similar and likely to asymptotically converge to the same value. We can easily calculate the exact frequencies of the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime in the sequence of LPDs of odd numbers in general: e.g. 3 will occur at
![fr=1/3](https://s0.wp.com/latex.php?latex=fr%3D1%2F3&bg=ffffff&fg=333333&s=0&c=20201002);
5 will occur at ![fr=(1-1/3)\\times 1/5=.13333](https://s0.wp.com/latex.php?latex=fr%3D%281-1%2F3%29%5Ctimes+1%2F5%3D.13333&bg=ffffff&fg=333333&s=0&c=20201002); 7 will occur at ![fr= (1-.\\overline{3}-.1\\overline{3})\\times 1/7 =0.07619048](https://s0.wp.com/latex.php?latex=fr%3D+%281-.%5Coverline%7B3%7D-.1%5Coverline%7B3%7D%29%5Ctimes+1%2F7+%3D0.07619048&bg=ffffff&fg=333333&s=0&c=20201002); 11 will occur at ![fr=
(1-.\\overline{3}-.1\\overline{3}-0.07619048)\\times 1/11
=0.04155844](https://s0.wp.com/latex.php?latex=fr%3D+%281-.%5Coverline%7B3%7D-.1%5Coverline%7B3%7D-0.07619048%29%5Ctimes+1%2F11+%3D0.04155844&bg=ffffff&fg=333333&s=0&c=20201002) and so on. Thus, we observe that the frequencies of the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime in ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002) notably differ from the frequencies of the same in the sequence of LPDs of odd numbers in general. We have not figured out if there is a means of exactly calculating the frequencies of the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime in ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002). Strangely, the first few frequencies are close to reciprocals of the sequence 2, 8, 16, 32, 41, 78, 90, 128, which relates to a certain co-primality triangle. While this make no sense at all to us, it is unclear if it is all chance or some relationship exists (see postscript).

We then investigated how exactly the record values of ![f_1\[n\], f_2\[n\]](https://s0.wp.com/latex.php?latex=f_1%5Bn%5D%2C+f_2%5Bn%5D&bg=ffffff&fg=333333&s=0&c=20201002) grow with
![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002).
This is shown in Figure 3.

[![primes2p_plus_1\_3](https://manasataramgini.files.wordpress.com/2018/05/primes2p_plus_1_3.png?w=640)](https://manasataramgini.files.wordpress.com/2018/05/primes2p_plus_1_3.png)Figure 3. ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002) plotted to 25997 terms

Visual examination of the plot showed that the record values
![M\_{2p\\pm
1}](https://s0.wp.com/latex.php?latex=M_%7B2p%5Cpm+1%7D&bg=ffffff&fg=333333&s=0&c=20201002) grow very similarly in but
![f_1](https://s0.wp.com/latex.php?latex=f_1&bg=ffffff&fg=333333&s=0&c=20201002)
and
![f_2](https://s0.wp.com/latex.php?latex=f_2&bg=ffffff&fg=333333&s=0&c=20201002)
and they are bounded by a smooth curve that appears to be of the form
![y=k x
\\log(x)](https://s0.wp.com/latex.php?latex=y%3Dk+x+%5Clog%28x%29&bg=ffffff&fg=333333&s=0&c=20201002), where
![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002)
is some constant. The original Gaussian form of the prime number counting function can be written as (using the asymptotic notation):  
![\\pi(x) \\sim
\\dfrac{x}{\\log(x)}](https://s0.wp.com/latex.php?latex=%5Cpi%28x%29+%5Csim+%5Cdfrac%7Bx%7D%7B%5Clog%28x%29%7D&bg=ffffff&fg=333333&s=0&c=20201002)  
From this we can write the expression for the
![n{th}](https://s0.wp.com/latex.php?latex=n%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime
![p_n](https://s0.wp.com/latex.php?latex=p_n&bg=ffffff&fg=333333&s=0&c=20201002)
thus:  
![p_n \\sim n
\\log(n)](https://s0.wp.com/latex.php?latex=p_n+%5Csim+n+%5Clog%28n%29&bg=ffffff&fg=333333&s=0&c=20201002)  
The record values of the LPDs of
![f_1,f_2](https://s0.wp.com/latex.php?latex=f_1%2Cf_2&bg=ffffff&fg=333333&s=0&c=20201002)
will be primes of the form ![2p_n \\pm 1](https://s0.wp.com/latex.php?latex=2p_n+%5Cpm+1&bg=ffffff&fg=333333&s=0&c=20201002). From this we can infer that that the record values of the two sequences
![M\_{2p\\pm
1}](https://s0.wp.com/latex.php?latex=M_%7B2p%5Cpm+1%7D&bg=ffffff&fg=333333&s=0&c=20201002) will be fitted by the curve:  
![y= 2x
\\log(x)](https://s0.wp.com/latex.php?latex=y%3D+2x+%5Clog%28x%29&bg=ffffff&fg=333333&s=0&c=20201002)

In Figure 3 this is plotted as the cyan curve. While this reasonably captures the behavior of of the bounding curve of ![M\_{2p\\pm 1}](https://s0.wp.com/latex.php?latex=M_%7B2p%5Cpm+1%7D&bg=ffffff&fg=333333&s=0&c=20201002), it systematically falls short of it. As we have seen before, the above Gaussian form of the prime counting function is only a crude approximation, which Gauss and Dirichlet eventually replaced with the logarithmic integral
![\\textrm{Li}(x)](https://s0.wp.com/latex.php?latex=%5Ctextrm%7BLi%7D%28x%29&bg=ffffff&fg=333333&s=0&c=20201002).
In this regard Rosser had proved long ago that ![p_n \\ge n\\log(n)](https://s0.wp.com/latex.php?latex=p_n+%5Cge+n%5Clog%28n%29&bg=ffffff&fg=333333&s=0&c=20201002); hence, what we see is a direct consequence of this. Inspired by the work of Chebyshev and Riemann, the obscure Russian village mathematician I.M. Pervushin (Pervouchine) investigated an exact formula for the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime using a table of 25997 primes (for numbers ![\\le 3 \\times 10^5](https://s0.wp.com/latex.php?latex=%5Cle+3+%5Ctimes+10%5E5&bg=ffffff&fg=333333&s=0&c=20201002)), which is coincidentally the same as the number we used in our investigation. Consequently he arrived at the remarkable formula:

![p_n \\approx n\\left(\\log(n)+\\log(\\log(n))-1 +\\dfrac{5\\log(n)}{12}-\\dfrac{1}{24\\left(\\log(n)\\right)^2}\\right)](https://s0.wp.com/latex.php?latex=p_n+%5Capprox+n%5Cleft%28%5Clog%28n%29%2B%5Clog%28%5Clog%28n%29%29-1+%2B%5Cdfrac%7B5%5Clog%28n%29%7D%7B12%7D-%5Cdfrac%7B1%7D%7B24%5Cleft%28%5Clog%28n%29%5Cright%29%5E2%7D%5Cright%29&bg=ffffff&fg=333333&s=0&c=20201002)

This formula inspired Ernesto Cesàro to discover the more correct formula for the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime:

![p_n=n\\Bigg(\\log(n)+\\log(\\log(n))-1 +\\dfrac{\\log(\\log(n))-2}{\\log(n)}-\\dfrac{\\left(\\log(\\log(n))\\right)^2-6\\log(\\log(n))+11}{2\\left(\\log(n)\\right)^2}\\\\ + o\\left(\\dfrac{1}{\\left(\\log(n)\\right)^2}\\right) \\Bigg)](https://s0.wp.com/latex.php?latex=p_n%3Dn%5CBigg%28%5Clog%28n%29%2B%5Clog%28%5Clog%28n%29%29-1+%2B%5Cdfrac%7B%5Clog%28%5Clog%28n%29%29-2%7D%7B%5Clog%28n%29%7D-%5Cdfrac%7B%5Cleft%28%5Clog%28%5Clog%28n%29%29%5Cright%29%5E2-6%5Clog%28%5Clog%28n%29%29%2B11%7D%7B2%5Cleft%28%5Clog%28n%29%5Cright%29%5E2%7D%5C%5C+%2B+o%5Cleft%28%5Cdfrac%7B1%7D%7B%5Cleft%28%5Clog%28n%29%5Cright%29%5E2%7D%5Cright%29+%5CBigg%29&bg=ffffff&fg=333333&s=0&c=20201002)

Here, the small-o notation can be interpreted to mean that the final error term is negligible compared to
![\\tfrac{1}{\\left(\\log(n)\\right)^2}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7B1%7D%7B%5Cleft%28%5Clog%28n%29%5Cright%29%5E2%7D&bg=ffffff&fg=333333&s=0&c=20201002)

Searching the literature, we found that recently Pierre Dusart had proved that

![p_n \\le n\\left(\\log(n)+\\log(\\log(n))-1 +\\dfrac{\\log(\\log(n))-2}{\\log(n)}\\right), \\; n \\ge 688383](https://s0.wp.com/latex.php?latex=p_n+%5Cle+n%5Cleft%28%5Clog%28n%29%2B%5Clog%28%5Clog%28n%29%29-1+%2B%5Cdfrac%7B%5Clog%28%5Clog%28n%29%29-2%7D%7B%5Clog%28n%29%7D%5Cright%29%2C+%5C%3B+n+%5Cge+688383&bg=ffffff&fg=333333&s=0&c=20201002)

Thus, for large
![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002)
the first 4 terms are sufficient. Hence, based on Cesàro’s formula we arrived at the approximate function for the behavior of ![M\_{2p\\pm 1}](https://s0.wp.com/latex.php?latex=M_%7B2p%5Cpm+1%7D&bg=ffffff&fg=333333&s=0&c=20201002):

![y=2x\\left(\\log(x)+\\log(\\log(x))-1 +\\dfrac{\\log(\\log(x))-2}{\\log(x)}\\right)](https://s0.wp.com/latex.php?latex=y%3D2x%5Cleft%28%5Clog%28x%29%2B%5Clog%28%5Clog%28x%29%29-1+%2B%5Cdfrac%7B%5Clog%28%5Clog%28x%29%29-2%7D%7B%5Clog%28x%29%7D%5Cright%29&bg=ffffff&fg=333333&s=0&c=20201002)

This uses only the first 4 terms of Cesàro’s formula but gives us a good fit as seen by the red curve in Figure 3. In numerical terms for the largest prime in both ![f_1, f_2](https://s0.wp.com/latex.php?latex=f_1%2C+f_2&bg=ffffff&fg=333333&s=0&c=20201002) for the first 25997 terms this approximation gives an error fraction of .002 suggesting that it is indeed a good one.

------------------------------------------------------------------------

After we posted this note on Twitter we rather quickly heard back from an acquaintence on that forum about his solution for exact form of the frequencies of the
![n^{th}](https://s0.wp.com/latex.php?latex=n%5E%7Bth%7D&bg=ffffff&fg=333333&s=0&c=20201002)
prime in the above sequences. You can read his excellent post [here](https://shreevatsa.github.io/site/smallest-prime-factor.html).
