+++
title = "The counting square and"
full_title = "The counting square and divisor functions"
upstream_url = "https://manasataramgini.wordpress.com/2023/09/09/the-counting-square-and-divisor-functions/"
date = "2023-09-09"

+++
Source: [here](https://manasataramgini.wordpress.com/2023/09/09/the-counting-square-and-divisor-functions/).

The counting square and divisor functions

Leonhard Euler’s discovery of the zeta function in the course of solving the Basel problem was one of those momentous “unifications” in mathematics with deep philosophical implications that eventually led to the Riemann hypothesis. By bringing together trigonometry and arithmetic, it presented the first glimmer in the Occident for an arithmetic foundation of the ideal world. We have found that it always helps to revisit the basics of knowledge and reflect upon it from the vantage point of all you learnt since you first acquired those basics. In this case, the basics that we shall revisit are counting with integers and operations related to them. When you learn those basics (close to the boundary from when life-long memories are retained), things like the values of the zeta function or even ![\pi](https://s0.wp.com/latex.php?latex=%5Cpi&bg=ffffff&fg=333333&s=0&c=20201002) beyond your very limited horizon (at least for most ordinary mortals). Hence, a glimpse of the deeper significance and philosophical implications of the basic operations appears only later in life. In this note, we detail one such exploration from our youth that brought home to us the connection between basic arithmetic and ![\pi](https://s0.wp.com/latex.php?latex=%5Cpi&bg=ffffff&fg=333333&s=0&c=20201002) via ![\zeta(2)](https://s0.wp.com/latex.php?latex=%5Czeta%282%29&bg=ffffff&fg=333333&s=0&c=20201002).

Consider the square matrix, which we call the counting box. It is a representation of the basic arithmetic operation of counting with integers from which we get both multiplication and division. It is constructed by filling successive columns of a ![n \times n](https://s0.wp.com/latex.php?latex=n+%5Ctimes+n&bg=ffffff&fg=333333&s=0&c=20201002) matrix by the first ![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002) elements of the following repeating sequences: 1,0,1,0,1,0,1,0 ![\ldots](https://s0.wp.com/latex.php?latex=%5Cldots&bg=ffffff&fg=333333&s=0&c=20201002); 1,2,0,1,2,0,1,2,0 ![\ldots](https://s0.wp.com/latex.php?latex=%5Cldots&bg=ffffff&fg=333333&s=0&c=20201002); 1,2,3,0,1,2,3,0,1,2,3,0 ![\ldots](https://s0.wp.com/latex.php?latex=%5Cldots&bg=ffffff&fg=333333&s=0&c=20201002). While the matrix can essentially be infinite, we can show ![n \times n](https://s0.wp.com/latex.php?latex=n+%5Ctimes+n&bg=ffffff&fg=333333&s=0&c=20201002) blocks of it (e.g., below, we have a ![n= 10](https://s0.wp.com/latex.php?latex=n%3D+10&bg=ffffff&fg=333333&s=0&c=20201002) matrix).

![count_square_matrix](https://manasataramgini.files.wordpress.com/2023/09/count_square_matrix.png?w=542&h=448)

Now, the upper triangle (diagonal included) of this matrix is rather predictable: row ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002), counting from 1, of this triangle will have a run of ![(n-k+1)](https://s0.wp.com/latex.php?latex=%28n-k%2B1%29&bg=ffffff&fg=333333&s=0&c=20201002) instances of ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002). The lower triangle of this matrix (diagonal excluded) is a little more interesting. Each row is the sequence ![k \mod 2, k \mod 3, \ldots, k \mod k](https://s0.wp.com/latex.php?latex=k+%5Cmod+2%2C+k+%5Cmod+3%2C+%5Cldots%2C+k+%5Cmod+k&bg=ffffff&fg=333333&s=0&c=20201002). Thus, for row 7 of the matrix, the corresponding row in the lower triangle is 1, 1, 3, 2, 1, 0. This is because, by its very definition, this array represents the division process by successive integers, and the remainders of these divisions will be seen in the successive elements of a row of the lower triangle. For a row ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) of the lower triangle of the matrix, the first ![\left\lfloor\tfrac{k}{2}\right\rfloor-1](https://s0.wp.com/latex.php?latex=%5Cleft%5Clfloor%5Ctfrac%7Bk%7D%7B2%7D%5Cright%5Crfloor-1&bg=ffffff&fg=333333&s=0&c=20201002) elements will be the unique reminder signature of the division of ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) by all integers ![\le \tfrac{k}{2}](https://s0.wp.com/latex.php?latex=%5Cle+%5Ctfrac%7Bk%7D%7B2%7D&bg=ffffff&fg=333333&s=0&c=20201002). The remaining ![\left\lceil\tfrac{k}{2}\right\rceil](https://s0.wp.com/latex.php?latex=%5Cleft%5Clceil%5Ctfrac%7Bk%7D%7B2%7D%5Cright%5Crceil&bg=ffffff&fg=333333&s=0&c=20201002) elements of this row of the lower triangle will be successive integers in decreasing order from ![\left\lceil\tfrac{k}{2}\right\rceil-1](https://s0.wp.com/latex.php?latex=%5Cleft%5Clceil%5Ctfrac%7Bk%7D%7B2%7D%5Cright%5Crceil-1&bg=ffffff&fg=333333&s=0&c=20201002) to 0. Thus, for both rows 9 and 10, this run will be 4, 3, 2, 1, 0.

We were curious about the curve defined by the values of the row-wise sums of the above matrix — the sum is plotted as the ![y](https://s0.wp.com/latex.php?latex=y&bg=ffffff&fg=333333&s=0&c=20201002) value and the corresponding row ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) as the ![x](https://s0.wp.com/latex.php?latex=x&bg=ffffff&fg=333333&s=0&c=20201002) value. This can be done for this matrix of any size ![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002); hence, to maintain the same scale, we normalized the curve by dividing the ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) values by ![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002) and the sums on the ![y](https://s0.wp.com/latex.php?latex=y&bg=ffffff&fg=333333&s=0&c=20201002) axis by the maximum value attained by the row sum. We then asked for what value of ![\tfrac{k}{n}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7Bk%7D%7Bn%7D&bg=ffffff&fg=333333&s=0&c=20201002) will the maximum sum (1 when normalized) be attained. We can easily place some lower bounds on it. As we saw above, each row of the upper triangle of the matrix has ![(n-k+1)](https://s0.wp.com/latex.php?latex=%28n-k%2B1%29&bg=ffffff&fg=333333&s=0&c=20201002) instances of ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002). Hence, the sum of these values would be the quadratic function ![s_1=(n+1)k-k^2](https://s0.wp.com/latex.php?latex=s_1%3D%28n%2B1%29k-k%5E2&bg=ffffff&fg=333333&s=0&c=20201002). Using some elementary calculus to find the maximum of this parabola, we see that it will be attained at ![k=\tfrac{n+1}{2}](https://s0.wp.com/latex.php?latex=k%3D%5Ctfrac%7Bn%2B1%7D%7B2%7D&bg=ffffff&fg=333333&s=0&c=20201002). Thus, when we normalize it for large ![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002), it will be practically at ![\tfrac{1}{2}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7B1%7D%7B2%7D&bg=ffffff&fg=333333&s=0&c=20201002). Hence, the maximum of the row sum of the matrix will certainly be attained at a value ![\>\tfrac{1}{2}](https://s0.wp.com/latex.php?latex=%3E%5Ctfrac%7B1%7D%7B2%7D&bg=ffffff&fg=333333&s=0&c=20201002) because the above only accounts for the upper triangle part of a given row. As we saw above, the terminal part of row ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) of the lower triangle has an arithmetic progression of integers from ![\left\lceil\tfrac{k}{2}\right\rceil-1 \ldots 1](https://s0.wp.com/latex.php?latex=%5Cleft%5Clceil%5Ctfrac%7Bk%7D%7B2%7D%5Cright%5Crceil-1+%5Cldots+1&bg=ffffff&fg=333333&s=0&c=20201002). The sum of this part will hence be:

![s_2=\dfrac{1}{2}\left(\left\lceil\tfrac{k}{2}\right\rceil^2-\left\lceil\tfrac{k}{2}\right\rceil \right)](https://s0.wp.com/latex.php?latex=s_2%3D%5Cdfrac%7B1%7D%7B2%7D%5Cleft%28%5Cleft%5Clceil%5Ctfrac%7Bk%7D%7B2%7D%5Cright%5Crceil%5E2-%5Cleft%5Clceil%5Ctfrac%7Bk%7D%7B2%7D%5Cright%5Crceil+%5Cright%29&bg=ffffff&fg=333333&s=0&c=20201002)

We can approximate this as:  
![s_2 \approx \dfrac{k^2-2k}{8}](https://s0.wp.com/latex.php?latex=s_2+%5Capprox+%5Cdfrac%7Bk%5E2-2k%7D%7B8%7D&bg=ffffff&fg=333333&s=0&c=20201002)  
![\therefore s_1+s_2 \approx k\left(n+\dfrac{3}{4}\right)- \dfrac{7k^2}{8}](https://s0.wp.com/latex.php?latex=%5Ctherefore+s_1%2Bs_2+%5Capprox+k%5Cleft%28n%2B%5Cdfrac%7B3%7D%7B4%7D%5Cright%29-+%5Cdfrac%7B7k%5E2%7D%7B8%7D&bg=ffffff&fg=333333&s=0&c=20201002)

Again, finding where the maximum occurs for this parabola, we get it as ![\tfrac{4}{7}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7B4%7D%7B7%7D&bg=ffffff&fg=333333&s=0&c=20201002) when ![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002) is large. Again the actual value where the maximum occurs would be greater than ![\tfrac{4}{7}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7B4%7D%7B7%7D&bg=ffffff&fg=333333&s=0&c=20201002) (Figure 1) because this sum still leaves out the first ![\left\lfloor\tfrac{k}{2}\right\rfloor-1](https://s0.wp.com/latex.php?latex=%5Cleft%5Clfloor%5Ctfrac%7Bk%7D%7B2%7D%5Cright%5Crfloor-1&bg=ffffff&fg=333333&s=0&c=20201002) forming the unique modulo signature of ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002). Given our limited knowledge when we did this exercise in our youth, this bound-setting, which a mathematician might laugh at, gave us a sense of what to expect — an approximately parabolic curve with maximum occurring for a ![\tfrac{k}{n} \>\tfrac{4}{7}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7Bk%7D%7Bn%7D+%3E%5Ctfrac%7B4%7D%7B7%7D&bg=ffffff&fg=333333&s=0&c=20201002). We then empirically computed the actual maximum (Figure 1) and obtained a value of ![0.608](https://s0.wp.com/latex.php?latex=0.608&bg=ffffff&fg=333333&s=0&c=20201002) — this immediately led us to realize that the maximum is attained at approximately ![\tfrac{1}{\zeta(2)}= \tfrac{6}{\pi^2}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7B1%7D%7B%5Czeta%282%29%7D%3D+%5Ctfrac%7B6%7D%7B%5Cpi%5E2%7D&bg=ffffff&fg=333333&s=0&c=20201002). Here, ![\zeta(x)](https://s0.wp.com/latex.php?latex=%5Czeta%28x%29&bg=ffffff&fg=333333&s=0&c=20201002) is the famous Zeta function known after Bernhard Riemann.

[![count_square_Fig1](https://manasataramgini.files.wordpress.com/2023/09/count_square_fig1.png?w=640)](https://manasataramgini.files.wordpress.com/2023/09/count_square_fig1.png)Figure 1.

Figure 2 shows the computation of the value of ![\tfrac{k}{n}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7Bk%7D%7Bn%7D&bg=ffffff&fg=333333&s=0&c=20201002) at which the maximum occurs for increasing values of ![n](https://s0.wp.com/latex.php?latex=n&bg=ffffff&fg=333333&s=0&c=20201002), which when averaged yields ![\approx \tfrac{6}{\pi^2}](https://s0.wp.com/latex.php?latex=%5Capprox+%5Ctfrac%7B6%7D%7B%5Cpi%5E2%7D&bg=ffffff&fg=333333&s=0&c=20201002).

[![count_square_Fig2](https://manasataramgini.files.wordpress.com/2023/09/count_square_fig2.png?w=640)](https://manasataramgini.files.wordpress.com/2023/09/count_square_fig2.png)Figure 2.

To understand why this was so, we next tackled the issue of the row sums of the lower triangle of this matrix. It is essentially the sum of the modulos: ![(2 \ldots k) \mod k](https://s0.wp.com/latex.php?latex=%282+%5Cldots+k%29+%5Cmod+k&bg=ffffff&fg=333333&s=0&c=20201002). Using the full square matrix we can infer this to be the below formula for row ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) (Figure 3):

[![count_square_Fig3](https://manasataramgini.files.wordpress.com/2023/09/count_square_fig3.png?w=640)](https://manasataramgini.files.wordpress.com/2023/09/count_square_fig3.png)Figure 3.

![\displaystyle S\_{ltr}= k^2 - \sum\_{j=1}^{k} \sigma_1(j)](https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+S_%7Bltr%7D%3D+k%5E2+-+%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Csigma_1%28j%29&bg=ffffff&fg=333333&s=0&c=20201002)

Here, ![\sigma_1(j)](https://s0.wp.com/latex.php?latex=%5Csigma_1%28j%29&bg=ffffff&fg=333333&s=0&c=20201002) is the arithmetic divisor function going back to the work of Dirichlet, which is simply the sum of all the divisors of an integer. This, in turn, yields the exact formula for the sum of the complete row ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) in the ![n \times n](https://s0.wp.com/latex.php?latex=n+%5Ctimes+n&bg=ffffff&fg=333333&s=0&c=20201002) matrix as (plotted in yellow in Figure 1):

![\displaystyle S_r= (n+1)k - \sum\_{j=1}^{k} \sigma_1(j)](https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+S_r%3D+%28n%2B1%29k+-+%5Csum_%7Bj%3D1%7D%5E%7Bk%7D+%5Csigma_1%28j%29&bg=ffffff&fg=333333&s=0&c=20201002)

Thus, the key to understanding how ![\zeta(2)](https://s0.wp.com/latex.php?latex=%5Czeta%282%29&bg=ffffff&fg=333333&s=0&c=20201002) emerges in this formula is to understand the sum of ![\sigma_1(k)](https://s0.wp.com/latex.php?latex=%5Csigma_1%28k%29&bg=ffffff&fg=333333&s=0&c=20201002). As above, we could empirically establish that asymptotically its first level approximation is ![\tfrac{\pi^2 k^2}{12}](https://s0.wp.com/latex.php?latex=%5Ctfrac%7B%5Cpi%5E2+k%5E2%7D%7B12%7D&bg=ffffff&fg=333333&s=0&c=20201002) (pink in Figure 3). Indeed, as a result of the work starting from Dirichlet in the 1800s and culminating in that of Hardy in the last century we have the asymptotic formula for the summatory function of ![\sigma_1(k)](https://s0.wp.com/latex.php?latex=%5Csigma_1%28k%29&bg=ffffff&fg=333333&s=0&c=20201002) as: ![S\_{\sigma_1} = \tfrac{\pi^2 k^2}{12} + O(k \log(k))](https://s0.wp.com/latex.php?latex=S_%7B%5Csigma_1%7D+%3D+%5Ctfrac%7B%5Cpi%5E2+k%5E2%7D%7B12%7D+%2B+O%28k+%5Clog%28k%29%29&bg=ffffff&fg=333333&s=0&c=20201002), where the Landau-Bachmann big ![O](https://s0.wp.com/latex.php?latex=O&bg=ffffff&fg=333333&s=0&c=20201002) notation is used for the second term. This formula is established by Hardy and Wright in their “An Introduction to the Theory of Numbers.”

The generalized version of the divisor function ![\sigma_n(k)](https://s0.wp.com/latex.php?latex=%5Csigma_n%28k%29&bg=ffffff&fg=333333&s=0&c=20201002) can be defined thus:

![\displaystyle \sigma_n(k) = \sum\_{d\|k} d^n](https://s0.wp.com/latex.php?latex=%5Cdisplaystyle+%5Csigma_n%28k%29+%3D+%5Csum_%7Bd%7Ck%7D+d%5En&bg=ffffff&fg=333333&s=0&c=20201002); here ![d\|k](https://s0.wp.com/latex.php?latex=d%7Ck&bg=ffffff&fg=333333&s=0&c=20201002) means ![d](https://s0.wp.com/latex.php?latex=d&bg=ffffff&fg=333333&s=0&c=20201002) divides ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002), i.e., is its divisor.

Thus ![\sigma_0(k)](https://s0.wp.com/latex.php?latex=%5Csigma_0%28k%29&bg=ffffff&fg=333333&s=0&c=20201002) is the divisor function which specifies the number of divisors. With this in place we can see, that the lower triangle of the matrix also encodes interesting numbers related to the divisor functions:

First, the number of 1s in each row of the lower triangle gives the sequence of the number of divisors of an integer that are greater than 1, i.e. the sequence of ![\sigma_0(k)-1 \to 0, 1, 1, 2, 1, 3, 1, 3, 2, 3, 1, 5 \ldots](https://s0.wp.com/latex.php?latex=%5Csigma_0%28k%29-1+%5Cto+0%2C+1%2C+1%2C+2%2C+1%2C+3%2C+1%2C+3%2C+2%2C+3%2C+1%2C+5+%5Cldots&bg=ffffff&fg=333333&s=0&c=20201002) The number of 0s in each row gives the same sequence without the initial 0. The number of non-0 terms of each row of this triangle gives: ![k-\sigma_0(k) \to 0, 1, 1, 3, 2, 5, 4, 6, 6, 9, 6, 11 \ldots](https://s0.wp.com/latex.php?latex=k-%5Csigma_0%28k%29+%5Cto+0%2C+1%2C+1%2C+3%2C+2%2C+5%2C+4%2C+6%2C+6%2C+9%2C+6%2C+11+%5Cldots&bg=ffffff&fg=333333&s=0&c=20201002) starting from ![k=2](https://s0.wp.com/latex.php?latex=k%3D2&bg=ffffff&fg=333333&s=0&c=20201002). The number of 2s in each row gives the number of divisors of ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) that are greater than 2. Likewise, the number of 3 in a given row specifies the number of divisors of ![k](https://s0.wp.com/latex.php?latex=k&bg=ffffff&fg=333333&s=0&c=20201002) that are greater than 3 and so on.
